import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d.art3d import Poly3DCollection, Line3DCollection

def draw_cube_3D(state, loc):
    square = np.array([
        (0, 0, 0), (1, 0, 0), (2, 0, 0), (3, 0, 0),
        (0, 1, 0), (1, 1, 0), (2, 1, 0), (3, 1, 0),
        (0, 2, 0), (1, 2, 0), (2, 2, 0), (3, 2, 0),
        (0, 3, 0), (1, 3, 0), (2, 3, 0), (3, 3, 0),

        (0, 0, 1), (1, 0, 1), (2, 0, 1), (3, 0, 1),
        (0, 1, 1),                       (3, 1, 1),
        (0, 2, 1),                       (3, 2, 1),
        (0, 3, 1), (1, 3, 1), (2, 3, 1), (3, 3, 1),

        (0, 0, 2), (1, 0, 2), (2, 0, 2), (3, 0, 2),
        (0, 1, 2),                       (3, 1, 2),
        (0, 2, 2),                       (3, 2, 2),
        (0, 3, 2), (1, 3, 2), (2, 3, 2), (3, 3, 2),

        (0, 0, 3), (1, 0, 3), (2, 0, 3), (3, 0, 3),
        (0, 1, 3), (1, 1, 3), (2, 1, 3), (3, 1, 3),
        (0, 2, 3), (1, 2, 3), (2, 2, 3), (3, 2, 3),
        (0, 3, 3), (1, 3, 3), (2, 3, 3), (3, 3, 3),
    ])
    faces = {
        'D': [[0, 1, 5, 4, 0], [1, 2, 6, 5, 1], [2, 3, 7, 6, 2],
            [4, 5, 9, 8, 4], [5, 6, 10, 9, 5], [6, 7, 11, 10, 6],
            [8, 9, 13, 12, 8], [9, 10, 14, 13, 9], [10, 11, 15, 14, 10]], 
        'U': [[48, 49, 53, 52, 48], [49, 50, 54, 53, 49], [50, 51, 55, 54, 50],
            [44, 45, 49, 48, 44], [45, 46, 50, 49, 45], [46, 47, 51, 50, 46],
            [40, 41, 45, 44, 40], [41, 42, 46, 45, 41], [42, 43, 47, 46, 42]],
        'F': [[40, 41, 29, 28, 40], [41, 42, 30, 29, 41], [42, 43, 31, 30, 42],
            [16, 17, 29, 28, 16], [17, 18, 30, 29, 17], [18, 19, 31, 30, 18],
            [16, 17, 1, 0, 16], [17, 18, 2, 1, 17], [18, 19, 3, 2, 18]],
        'B': [[55, 54, 38, 39, 55], [54, 53, 37, 38, 54], [53, 52, 36, 37, 53],
            [27, 26, 38, 39, 27], [26, 25, 37, 38, 26], [25, 24, 36, 37, 25],
            [27, 26, 14, 15, 27], [26, 25, 13, 14, 26], [25, 24, 12, 13, 25]],
        'L': [[52, 48, 34, 36, 52], [48, 44, 32, 34, 48], [44, 40, 28, 32, 44],
            [24, 22, 34, 36, 24], [22, 20, 32, 34, 22], [20, 16, 28, 32, 20],
            [24, 22, 8, 12, 24], [22, 20, 4, 8, 22], [20, 16, 0, 4, 20]],
        'R': [[43, 47, 33, 31, 43], [47, 51, 35, 33, 47], [51, 55, 39, 35, 51], 
            [19, 21, 33, 31, 19], [21, 23, 35, 33, 21], [23, 27, 39, 35, 23],
            [19, 21, 7, 3, 19], [21, 23, 11, 7, 21], [23, 27, 15, 11, 23]]
    }
        
    colors = {'⬜':'w', '🟨':'#FBFF34', '🟥':'r', '🟦':'b', '🟩':'g', '🟧':'orange'}


    # 提取顶点坐标
    x = square[:, 0]
    y = square[:, 1]
    z = square[:, 2]

    # 创建绘图对象
    fig = plt.figure()
    ax = fig.add_subplot(111, projection='3d')

    # 绘制立方体的顶点
    # ax.scatter(x, y, z, c='b', marker='o')
    for f in ['U', 'D', 'L', 'R', 'F', 'B']:
        # try:
        #     faces[f][0]
        # except:
        #     continue
        face_state = state[loc[f]].flatten()
        for i in range(9):
            poly3d = [[square[vert_id] for vert_id in faces[f][i]]]
            ax.add_collection3d(Poly3DCollection(poly3d, facecolors=colors[face_state[i]], linewidths=1, alpha=0.9))
            ax.add_collection3d(Line3DCollection(poly3d, colors='k', linewidths=1, linestyles='-'))

    # 设置坐标轴刻度
    ax.axis('off')
    ax.set_xlim([0, 3])
    ax.set_ylim([0, 3])
    ax.set_zlim([0, 3])
    ax.set_aspect('equal')

    # 显示图形
    plt.show()



# state = {
#             'U': np.array([['⬜', '⬜', '⬜'], ['⬜', '⬜', '⬜'], ['⬜', '⬜', '⬜']]),
#             'F': np.array([['🟩', '🟩', '🟩'], ['🟩', '🟩', '🟩'], ['🟩', '🟩', '🟩']]),
#             'R': np.array([['🟥', '🟥', '🟥'], ['🟥', '🟥', '🟥'], ['🟥', '🟥', '🟥']]),
#             'B': np.array([['🟦', '🟦', '🟦'], ['🟦', '🟦', '🟦'], ['🟦', '🟦', '🟦']]),
#             'L': np.array([['🟧', '🟧', '🟧'], ['🟧', '🟧', '🟧'], ['🟧', '🟧', '🟧']]),
#             'D': np.array([['🟨', '🟨', '🟨'], ['🟨', '🟨', '🟨'], ['🟨', '🟨', '🟨']])
#         }
# draw_cube_3D(state)